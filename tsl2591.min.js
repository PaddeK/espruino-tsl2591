"use strict";let q=t=>new Error(t),u=void 0,G={LOW:0,MED:16,HIGH:32,MAX:48},I={MS100:0,MS200:1,MS300:2,MS400:3,MS500:4,MS600:5},w=(t,e,i)=>!t.i.writeTo(41,[160|e].concat(i===u?[]:[i])),r=(t,e,i)=>w(t,e||0)&&t.i.readFrom(41,i||1)[i?"buffer":"0"],a=(t,e)=>new DataView(r(t,20,4)).getUint16(e,1),m=(t,e)=>Object.keys(t).some(i=>t[i]===e),c=t=>w(t,1,t.g|t.n),e=t=>w(t,0,t.e),h=(t,e)=>t.isAlsEnabled()?t.disable(2)&&e()&&t.enable(2):e(),z=(t,e,i)=>i=setInterval(()=>t.isAlsValid()&&!clearInterval(i)&&e.call(t),10),T=exports=function(t){let e=t._options.bitrate;if(this.i=t,!(t instanceof I2C))throw q("Parameter has to be a I2C object");if(e>4e5||e<1)throw q("Supported bitrate of TSL2591 is 1Hz to 400KHz");if(80!==r(this,18))throw q("Device at given I2C port is not a TSL2591");this.g=this.getGain(),this.n=this.getIntegration(),this.e=r(this),this.setToSleep()};T.LIGHT={FULLSPECTRUM:0,VISIBLE:1,INFRARED:2},T.GAIN=G,T.INTEGRATIONTIME=I,T.ENABLE={NPIEN:128,SAI:64,AIEN:16,AEN:2,PON:1},T.prototype={isSaiEnabled:()=>!!(64&r(this)),isPersistIntEnabled:()=>!!(16&r(this)),isIntEnabled:()=>!!(128&r(this)),isAlsEnabled:()=>!!(2&r(this)),enable:t=>0==(28&t)&&(this.e=3|t,1)&&e(this),disable:t=>0==(this.e&~t&28)&&(this.e&=~t,1)&&e(this),setToSleep:()=>(this.e=0,e(this)),setIntegration:t=>m(I,t)&&(this.n=t,1)&&c(this),setGain:t=>m(G,t)&&(this.g=t,1)&&h(this,c.bind(null,this)),getIntegration:()=>7&r(this,1),getGain:()=>48&r(this,1),clearInterrupt:()=>w(this,234),clearPersistInterrupt:()=>w(this,230),clearAllInterrupts:()=>w(this,231),isAlsValid:()=>!!(1&r(this,19)),hasIntOccured:()=>!!(32&r(this,19)),hasPersistIntOccured:()=>!!(16&r(this,19)),getLuminosity:(t,e)=>{let i,s,n=this;n.enable(),z(n,()=>{i=a(n,0),s=a(n,2),e(-1!==[i,s].indexOf([36863,65535][~~(7&r(n,1))])?-1:((t,e,i)=>i%2?t-e:[t,e][~~!!i])(i,s,t)),!(128&r(n))&&!(16&r(n))&&n.disable(3)})},registerInterrupt:(t,e,i)=>{let s=this,r=~~(i===u),a=8-(1-r<<2);s.enable([16,128][r]),[t,t>>8,e,e>>8].forEach(t=>w(s,a++,t)),!r&&w(s,12,i>3?~~(i/5)%15+3:i%4)}};